<header data-current-skin="{{mactrl.currentSkin}}" data-ng-controller="headerCtrl as hctrl" data-ng-include="'/template/header.html'" id="header">
</header>
<section class="h-100vh" id="main">
    <aside data-ng-class="{ 'toggled': mactrl.sidebarToggle.left === true }" data-ng-include="'/template/sidebar-left.html'" id="sidebar">
    </aside>
    <aside data-ng-class="{ 'toggled': mactrl.sidebarToggle.right === true }" data-ng-include="'/template/chat.html'" id="chat">
    </aside>
    <section id="content">
        <div class="container w-100 p-section-reservation p-r-0">
            <div class="reservation-content-header">
                <div class="pull-left">
                    <button class="btn bgm-bluegray" ng-click="prevZone()"><i class="zmdi zmdi-arrow-back"></i></button>
                    <button class="btn bgm-bluegray" ng-click="nextZone()"><i class="zmdi zmdi-arrow-forward"></i></button>
                    <label class="control-label">{{ zoneName }}</label>
                </div>
                <div class="pull-right">
                    <button class="btn bgm-bluegray" ng-click="selectTableAllOrNone('all')">Seleccionar todo</button>
                    <button class="btn bgm-bluegray" ng-click="selectTableAllOrNone('none')">Seleccionar niguno</button>
                </div>
            </div>
            <div class="box-zone-create p-t-15 p-b-15">
                <div class="box-lienzo-zone-v2">
                    <div id="lienzo" class="lienzo-v2" ng-drop="true" ng-drop-success="onDropComplete($data,$event)" ng-style="{width: size, height: size, 'font-size': fontSize}"
                        ng-repeat="zone in zones" ng-show="$index == zoneIndex">
                            <div class="item-drag-table rt{{obj.rotate}} shape-table table-zone" ng-class="[obj.shape, obj.size, {'selected-table': obj.selected, 'block-table': obj.block,'occupied-table': obj.occupied}]" ng-style="{top: obj.top, left: obj.left}" ng-click="selectTable(obj)" ng-repeat="obj in zone.tables">
                                <div class="table-label top">{{obj.name}}</div>
                                <div class="item-drag-cover" ng-hide="obj.suggested || obj.occupied">{{ obj.minCover }}-{{ obj.maxCover }}</div>
                                <div class="item-suggested" ng-show="obj.suggested"></div>
                                <div class="item-occupied" ng-show="obj.occupied"></div>
                            </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</section>
<section class="section-left-reservation">
    <div class="card form-drag" style="height: 100%; overflow-y: auto;">
        <div class="card-header" style="text-align: center; line-height: 30px; color: #FFF;">
            <button class="btn btn-danger pull-left" ng-click="cancel()">Cancelar</button>
            Agregar reservacion
            <button class="btn btn-primary pull-right" ng-click="save()" ng-disabled="waitingResponse">Guardar</button>
        </div>
        <div class="card-body">
            <div class="card reservation-guest-form" ng-show="addGuest">
                <div class="card-body drag-border">
                    <form class="form-horizontal" role="form">
                        <div class="reservation-new-guest" >
                            <div class="form-group">
                                <label class="col-xs-2 control-label" for="name">
                                    Nombres
                                </label>
                                <div class="col-xs-10">
                                    <div class="fg-line">
                                            <input type="text" class="form-control input" id="name" ng-model="newGuest.first_name" ng-change="searchGuest(newGuest.first_name)"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label" for="last_name">
                                    Apellidos
                                </label>
                                <div class="col-xs-10">
                                    <div class="fg-line">
                                            <input type="text" class="form-control input" id="last_name" ng-model="newGuest.last_name"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label" for="phone">
                                    Telefono
                                </label>
                                <div class="col-xs-10">
                                    <div class="fg-line">
                                            <input type="text" class="form-control input" id="phone" ng-model="newGuest.phone"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-xs-2 control-label" for="email">
                                    Email
                                </label>
                                <div class="col-xs-10">
                                    <div class="fg-line">
                                            <input type="text" class="form-control input" id="email" ng-model="newGuest.email"/>
                                    </div>
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="col-xs-12">
                                    <a href="javascript:void(0);" class="a-tittle" ng-click="addGuest=!addGuest">cancelar</a>
                                </div>
                            </div>

                            <div class="guest-search-list">
                                <div class="card m-0">
                                    <div class="card-header bgm-amber" ng-repeat="guest in guestList" ng-click="selectGuest(guest)">
                                        <h5>{{ guest.first_name + ", " + guest.last_name}}</h5>
                                        <span ng-repeat="phone in guest.phones">tel: {{ phone.number }}</span>
                                        <span ng-repeat="mail in guest.emails" ng-if="!guest.phones.length">email: {{ mail.email }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
           </div>

            <div class="card reservation-guest" ng-hide="addGuest || reservation.guest_id">
                <div class="card-header bgm-blue"  ng-click="addGuest=!addGuest">
                    <h2>Agregar Invitado</h2>
                </div>
           </div> 

           <div class="card reservation-guest-selected" ng-show="reservation.guest_id">
               <div class="card-header bgm-indigo" ng-click="removeGuest()">
                   <h2>{{ guest.first_name + ", " + guest.last_name}}</h2>
                   <span ng-repeat="phone in guest.phones">tel: {{ phone.number }}</span>
                   <span ng-repeat="mail in guest.emails" ng-if="!guest.phones.length">email: {{ mail.email }}</span>
                   <span class="remove-guest">click para elejir nuevo invitado</span>
               </div>
          </div> 

            <div class="card m-b-5">
                <form class="form-horizontal" role="form">
                    <div class="card-body drag-border">
                        <div class="form-group">
                            <label class="col-xs-2 control-label" for="status">
                                Estado
                            </label>
                            <div class="col-xs-10">
                                <div class="fg-line">
                                    <div class="select">
                                        <select class="form-control" id="status" ng-model="reservation.status_id" ng-options="status.id as status.name for status in statuses">
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-2 control-label" for="covers">
                                Invitados
                            </label>
                            <div class="col-xs-10">
                                <div class="fg-line">
                                    <div class="select">
                                        <select class="form-control" id="covers" ng-model="reservation.covers" ng-options="cover.id as cover.name for cover in covers" ng-change="tablesSuggested(reservation.covers)">
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-2 control-label" for="date">
                                Fecha
                            </label>
                            <div class="col-xs-10">
                                <div class="fg-line">
                                    <input class="form-control" id="date" type="date" ng-model="date" ng-value="date" />
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="border-right">
                                <label class="col-xs-2 control-label" for="hour">
                                    Hora
                                </label>
                                <div class="col-xs-4">
                                    <div class="fg-line">
                                        <div class="select">
                                            <select class="form-control" id="hour" ng-model="reservation.hour" ng-options="hour.time as hour.name group by hour.turn for hour in hours" ng-change="tablesBlockValid()">
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <label class="col-xs-2 control-label" for="duration">
                                Duracion
                            </label>
                            <div class="col-xs-4">
                                <div class="fg-line">
                                    <div class="select">
                                        <select class="form-control" id="duration" ng-model="reservation.duration" ng-options="duration.time as duration.name for duration in durations" ng-change="tablesBlockValid()">
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-2 control-label" for="server">
                                Mozo
                            </label>
                            <div class="col-xs-10">
                                <div class="fg-line">
                                    <div class="select">
                                        <select class="form-control" id="server" ng-model="reservation.server_id" ng-options="server.id as server.name for server in servers">
                                            <option selected="true" value="">
                                                Ninguno
                                            </option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group" style="display: table; width: 100%;">
                            <label class="col-xs-2 control-label" for="server">
                                Mesas
                            </label>
                            <div class="col-xs-10">
                                <div ng-if="!isTablesSelected">
                                    <label class="control-label" for="server" style="color: #8c8c8c;">{{ tableSuggested.name || "Sin mesas" }}</label>
                                    <a class="a-title pull-right" ng-show="tableSuggested.name" style="padding-top: 7px">Sugerido</a>
                                </div>

                                <label class="control-label p-r-5" for="server" ng-repeat="table in  tablesSelected track by $index">{{ table.name + ($last ? '' : ', ') }}</label>

                            </div>
                        </div>
                        <div class="form-group">
                            <div class="col-xs-12">
                                <div class="fg-line">
                                    <textarea class="form-control input-sm" placeholder="Introducir notas acerca de esta reserva aquí" ng-model="reservation.note"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-xs-7 control-label itext-left" for="server">
                                Etiquetas de reservación
                            </label>
                            <div class="col-xs-5">
                                <!-- <a class="pull-right" href="javascript:void(0);" style="padding-top: 7px">Editar Etiquetas</a> -->

                                <div class="clearfix dropdown-btn-demo pull-right" style="padding-top: 7px">
                                    <div class="dropdown dropup" uib-dropdown>
                                        <!-- <button class="dropdown-toggle btn btn-default" uib-dropdown-toggle> Editar Etiquetas</button> -->
                                        <a class="dropdown-toggle" uib-dropdown-toggle href="javascript:void(0);" >Editar Etiquetas</a>
                                        <ul class="dropdown-menu pull-right">
                                            <li data-ng-repeat="tag in tags">
                                                <a href="" ng-click="addTag(tag)">{{ tag.name }} <i class="zmdi zmdi-check zmdi-hc-fw pull-right" ng-show="tag.checked"></i></a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-12">
                                <button type="button" class="btn bgm-lightblue btn-xs m-r-5 disabled" ng-repeat="tag in selectTags">{{ tag.name }}</button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

      
            <div class="card">
                <div class="card-header bgm-amber" style="margin-bottom: 5px;" ng-repeat="conflict in conflicts">
                    <h5>Conflicto en mesa - {{ conflict.name }}</h5><span>{{ conflict.desc }}</span>
                </div>
            </div>

<!--       <div class="popover-demo">
                <div class="popover right bgm-amber" ng-repeat="conflict in conflicts track by $index"
                    style="display: block; margin: 0 0 5px 0 !important;  /*max-width: 100%;*/">
                    <div class="arrow"></div>
                    <h3 class="popover-title" style="padding: 5px; background: transparent;">Conflicto en mesa - {{ conflict.name }}</h3>
                    <div class="popover-content" style="padding: 0 0 5px 5px;">
                        <p>mesa  demasiado grande.</p>
                    </div>
                </div>
            </div> -->

        </div>
    </div>
</section>
